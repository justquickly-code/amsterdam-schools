"use client";

export type Language = "nl" | "en";

export const DEFAULT_LANGUAGE: Language = "nl";
export const LANGUAGE_EVENT = "language-changed";

export function readStoredLanguage(): Language {
  if (typeof window === "undefined") return DEFAULT_LANGUAGE;
  const stored = window.localStorage.getItem("schools_language");
  return stored === "en" || stored === "nl" ? stored : DEFAULT_LANGUAGE;
}

const STRINGS: Record<Language, Record<string, string>> = {
  nl: {
    "login.title": "Inloggen",
    "login.subtitle": "Gebruik een e‑mail van een familielid. Je blijft ingelogd op dit apparaat.",
    "login.use_last": "Gebruik laatste e‑mail",
    "login.email": "E‑mail",
    "login.send_link": "Stuur inloglink",
    "login.sending": "Verzenden...",
    "login.sent": "Check je e‑mail voor de link.",
    "login.invalid_email": "Vul een geldig e‑mailadres in.",
    "login.sign_in": "Ga naar inloggen",

    "dashboard.title": "Dashboard",
    "dashboard.welcome": "Welkom",
    "dashboard.finish_setup": "Maak de setup af",
    "dashboard.finish_setup_body":
      "Vul de naam van het kind, het adres en het advies in om filters en reistijd te personaliseren.",
    "dashboard.finish_setup_cta": "Ga naar instellingen",
    "dashboard.upcoming": "Aankomende open dagen",
    "dashboard.no_upcoming": "Geen open dagen gevonden.",
    "dashboard.view_all": "Bekijk alle open dagen",
    "dashboard.progress_title": "Voortgang",
    "dashboard.progress_complete": "compleet",
    "dashboard.tip_profile": "Maak je profiel compleet om te starten.",
    "dashboard.tip_invite": "Nodig een familielid uit om samen te plannen.",
    "dashboard.tip_shortlist": "Voeg je eerste school toe aan de shortlist.",
    "dashboard.tip_note": "Voeg een eerste notitie toe aan een school.",
    "dashboard.tip_rating": "Geef een eerste beoordeling aan een school.",
    "dashboard.tip_tutorial": "Bekijk kort hoe de Amsterdamse procedure werkt.",
    "dashboard.tip_attended": "Markeer een bezoek.",
    "dashboard.tip_done": "Alles staat op groen. Goed bezig!",
    "dashboard.tip_cta_settings": "Ga naar instellingen",
    "dashboard.tip_cta_schools": "Ga naar scholen",
    "dashboard.tip_cta_open_days": "Ga naar open dagen",
    "dashboard.tip_cta_tutorial": "Bekijk de uitleg",
    "dashboard.milestone_profile": "Profiel af",
    "dashboard.milestone_invite": "Uitnodiging",
    "dashboard.milestone_shortlist": "Eerste school",
    "dashboard.milestone_note": "Eerste notitie",
    "dashboard.milestone_rating": "Eerste beoordeling",
    "dashboard.milestone_tutorial": "Uitleg bekeken",
    "dashboard.milestone_attended": "Bezoek gemarkeerd",
    "dashboard.recent_title": "Recent:",
    "dashboard.recent_empty": "Nog niets afgerond.",
    "dashboard.next_dates_title": "Volgende belangrijke data",
    "dashboard.next_dates_none": "Geen data gevonden.",
    "dashboard.tip":
      "Tip: na het inloggen kun je scholen bekijken, notities maken, een ranglijst maken en open dagen zien.",
    "dashboard.signin_body":
      "Log in met een e‑mail van een familielid. Je blijft ingelogd op dit apparaat.",

    "setup.title": "Welkom",
    "setup.intro": "Laten we het even instellen. Dit duurt ongeveer een minuut.",
    "setup.profile_why":
      "We gebruiken dit om scholen te filteren op advies en om reistijden te berekenen.",
    "setup.finish": "Setup afronden",
    "setup.next": "Volgende",
    "setup.saving": "Opslaan...",
    "setup.thanks": "Bedankt",
    "setup.go_dashboard": "Ga naar Dashboard",
    "setup.signout": "Uitloggen",
    "setup.required_title": "Setup vereist",
    "setup.required_body":
      "Alleen de eigenaar kan de setup afronden. Vraag de eigenaar om het profiel af te maken.",
    "setup.invite_intro": "Wil je samen plannen? Nodig een familielid uit.",
    "setup.invite_shared":
      "Familieleden zien dezelfde scholen, shortlist en open dagen. Notities zijn per persoon en voor iedereen zichtbaar.",
    "setup.invite_label": "E-mailadres familielid",
    "setup.invite_send": "Stuur uitnodiging",
    "setup.invite_sending": "Versturen...",
    "setup.invite_invalid": "Vul een geldig e-mailadres in.",
    "setup.invite_auth_required": "Je moet ingelogd zijn om een uitnodiging te sturen.",
    "setup.invite_failed": "Uitnodiging mislukt.",
    "setup.invite_already_sent": "Uitnodiging is al verstuurd.",
    "setup.invite_sent": "Uitnodiging verstuurd.",
    "setup.invite_later": "Je kunt later ook familie toevoegen via Instellingen.",
    "setup.skip": "Nu overslaan",
    "setup.continue": "Doorgaan",
    "setup.tutorial_intro": "Wil je weten hoe de Amsterdamse procedure werkt?",
    "setup.tutorial_body":
      "Dit is geen app‑uitleg, maar een korte, kindvriendelijke uitleg van het proces in 2025/26.",
    "setup.tutorial_start": "Start uitleg",
    "setup.tutorial_later": "Je kunt dit later altijd terugvinden in het menu.",

    "settings.title": "Instellingen",
    "settings.edit": "Instellingen bewerken",
    "settings.child_name": "Naam kind",
    "settings.postcode": "Postcode",
    "settings.house_number": "Huisnummer",
    "settings.advies1": "Advies",
    "settings.advies2": "Advies (optioneel)",
    "settings.advies_select": "Kies advies",
    "settings.both_levels": "Toon alleen scholen die BEIDE niveaus aanbieden",
    "settings.save": "Opslaan",
    "settings.saving": "Opslaan...",
    "settings.language": "Taal",
    "settings.lang_nl": "Nederlands",
    "settings.lang_en": "English",

    "menu.settings": "Instellingen",
    "menu.how_it_works": "Hoe werkt het?",
    "menu.feedback": "Feedback",
    "menu.print": "Print / Export",
    "menu.admin": "Admin",
    "menu.signout": "Uitloggen",

    "nav.dashboard": "Dashboard",
    "nav.schools": "Scholen",
    "nav.open_days": "Open dagen",
    "nav.shortlist": "Shortlist",

    "schools.title": "Scholen",
    "schools.search": "Zoek scholen…",
    "schools.sort": "Sorteren",
    "schools.sort_name": "Naam",
    "schools.sort_bike": "Fietstijd",
    "schools.shortlist_add": "Toevoegen",
    "schools.shortlist_adding": "Toevoegen...",
    "schools.shortlist_add_full": "Toevoegen aan shortlist",
    "schools.shortlist_added_ranked": "Toegevoegd aan ranglijst op #{rank}.",
    "schools.shortlist_added_unranked": "Toegevoegd aan shortlist (nog niet gerangschikt).",
    "schools.shortlist_already": "Staat al in de shortlist.",

    "open_days.title": "Open dagen",
    "open_days.important": "Belangrijk",
    "open_days.important_body":
      "Details kunnen veranderen. Controleer altijd de schoolwebsite voordat je gaat.",
    "open_days.shortlist_only": "Alleen shortlist",
    "open_days.show_inactive": "Toon inactief",
    "open_days.event_type": "Type",
    "open_days.when": "Wanneer",
    "open_days.all_dates": "Alle data",
    "open_days.next7": "Volgende 7 dagen",
    "open_days.next14": "Volgende 14 dagen",

    "shortlist.title": "Ranglijst",
    "shortlist.subtitle": "Je kunt meer scholen bewaren dan je ranglijst.",
    "shortlist.empty_slot": "Leeg",
    "shortlist.empty_list": "Je hebt nog geen scholen gerangschikt.",
    "shortlist.save": "Opslaan",
    "shortlist.saved": "Opgeslagen.",
    "shortlist.rank": "Rang",
    "shortlist.remove": "Verwijder",
    "shortlist.footer": "Volgende stap: voeg scholen toe via de scholenlijst of detailpagina.",
    "shortlist.rank_cap": "Ranglimiet",
    "shortlist.saved_title": "Bewaard (nog niet gerangschikt)",
    "shortlist.rank_next": "Zet op volgende rang",

    "how.title": "Hoe werkt het?",
    "how.subtitle":
      "Een korte, kindvriendelijke uitleg van de Amsterdamse stap‑voor‑stap procedure voor 2025/26.",
    "how.next_title": "Eerstvolgende momenten",
    "how.complete_cta": "Ik heb dit gelezen",
    "how.completed": "Gelezen ✓",
    "how.finish_setup": "Naar Dashboard",
    "how.to_dashboard": "Naar Dashboard",
    "how.list_title": "Hoe lang moet je lijst zijn?",
    "how.list_intro": "De Keuzegids raadt minimaal aan:",
    "how.list_4": "vmbo-b / vmbo-bk / vmbo-k / vmbo-kgl-tl: 4 scholen",
    "how.list_6": "vmbo-gl-tl / vmbo-gl-tl-havo: 6 scholen",
    "how.list_12": "havo / havo-vwo / vwo: 12 scholen",
    "how.list_note":
      "Kies je ook een profielklas bij dezelfde school? Dan kan je lijst langer moeten zijn.",
    "how.title_provisional": "Voorlopig advies (januari)",
    "how.body_provisional":
      "Je krijgt een voorlopig advies van school. Dat is je startpunt voor het kiezen.",
    "how.title_orientation": "Oriëntatie (nov–feb)",
    "how.body_orientation":
      "Bezoek open dagen en kijk rond. Gebruik je checklist om scholen te vergelijken.",
    "how.title_doorstroom": "Doorstroomtoets (2–6 feb)",
    "how.body_doorstroom":
      "Alle groep‑8 leerlingen maken de toets in deze week.",
    "how.title_definitive": "Definitief advies (24 maart)",
    "how.body_definitive":
      "Uiterlijk deze datum krijg je je definitieve advies.",
    "how.title_apply": "Centrale aanmeldweek (25–31 maart)",
    "how.body_apply":
      "Je zet je voorkeuren in volgorde en meldt je online aan.",
    "how.title_placement": "Uitslag loting/matching (9 april)",
    "how.body_placement":
      "Je hoort op welke school je bent geplaatst.",
    "how.title_second_round": "Tweede ronde (9–14 april)",
    "how.body_second_round":
      "Alleen als je geen plaats hebt of wisselt van keuze.",
    "how.title_meet": "Kennismaken (23/24 juni)",
    "how.body_meet":
      "Je gaat naar de kennismakingsmiddag van je nieuwe school.",

    "feedback.title": "Feedback",
    "feedback.subtitle": "Deel bugs, ideeën of vragen. We lezen alles.",
    "feedback.category": "Categorie",
    "feedback.category_bug": "Bug",
    "feedback.category_idea": "Idee",
    "feedback.category_question": "Vraag",
    "feedback.category_other": "Anders",
    "feedback.title_label": "Titel (optioneel)",
    "feedback.message_label": "Bericht",
    "feedback.send": "Verstuur feedback",
    "feedback.sending": "Versturen...",
    "feedback.empty": "Nog geen feedback.",
    "feedback.your": "Jouw feedback",
    "feedback.response": "Reactie",
    "feedback.new_response": "Nieuwe reactie",
    "feedback.thanks": "Bedankt! We kijken ernaar.",
  },
  en: {
    "login.title": "Sign in",
    "login.subtitle": "Use a family member email. The app stays signed in on this device.",
    "login.use_last": "Use last email",
    "login.email": "Email",
    "login.send_link": "Send sign-in link",
    "login.sending": "Sending...",
    "login.sent": "Check your email for the sign-in link.",
    "login.invalid_email": "Please enter a valid email address.",
    "login.sign_in": "Go to sign in",

    "dashboard.title": "Dashboard",
    "dashboard.welcome": "Welcome",
    "dashboard.finish_setup": "Finish setup",
    "dashboard.finish_setup_body":
      "Add the child’s name, home address, and advies level to personalize filters and commute times.",
    "dashboard.finish_setup_cta": "Go to settings",
    "dashboard.upcoming": "Upcoming open days",
    "dashboard.no_upcoming": "No upcoming open days found.",
    "dashboard.view_all": "View all open days",
    "dashboard.progress_title": "Progress",
    "dashboard.progress_complete": "complete",
    "dashboard.tip_profile": "Complete your profile to get started.",
    "dashboard.tip_invite": "Invite a family member to plan together.",
    "dashboard.tip_shortlist": "Add your first school to the shortlist.",
    "dashboard.tip_note": "Add your first note to a school.",
    "dashboard.tip_rating": "Add your first rating to a school.",
    "dashboard.tip_tutorial": "See the quick Amsterdam process overview.",
    "dashboard.tip_attended": "Mark a visit.",
    "dashboard.tip_done": "You’re all set. Nice work!",
    "dashboard.tip_cta_settings": "Go to settings",
    "dashboard.tip_cta_schools": "Go to schools",
    "dashboard.tip_cta_open_days": "Go to open days",
    "dashboard.tip_cta_tutorial": "View the overview",
    "dashboard.milestone_profile": "Profile done",
    "dashboard.milestone_invite": "Invite sent",
    "dashboard.milestone_shortlist": "First school",
    "dashboard.milestone_note": "First note",
    "dashboard.milestone_rating": "First rating",
    "dashboard.milestone_tutorial": "Overview done",
    "dashboard.milestone_attended": "Visit marked",
    "dashboard.recent_title": "Recently:",
    "dashboard.recent_empty": "Nothing completed yet.",
    "dashboard.next_dates_title": "Next important dates",
    "dashboard.next_dates_none": "No dates found.",
    "dashboard.tip":
      "Tip: once signed in, you’ll be able to browse schools, save visit notes, build a ranked list, and see open days.",
    "dashboard.signin_body":
      "Sign in with a family member email. The app stays signed in on this device.",

    "setup.title": "Welcome",
    "setup.intro": "Let’s set things up. It takes about a minute.",
    "setup.profile_why": "We use this to filter by advice and calculate commute times.",
    "setup.finish": "Finish setup",
    "setup.next": "Next",
    "setup.saving": "Saving...",
    "setup.thanks": "Thanks",
    "setup.go_dashboard": "Go to Dashboard",
    "setup.signout": "Sign out",
    "setup.required_title": "Setup required",
    "setup.required_body": "Only the workspace owner can complete setup. Ask them to finish the profile.",
    "setup.invite_intro": "Plan together? Invite a family member.",
    "setup.invite_shared":
      "Family members share the same schools, shortlist, and open days. Notes are per person and visible to everyone.",
    "setup.invite_label": "Family member email",
    "setup.invite_send": "Send invite",
    "setup.invite_sending": "Sending...",
    "setup.invite_invalid": "Enter a valid email address.",
    "setup.invite_auth_required": "You must be signed in to send an invite.",
    "setup.invite_failed": "Invite failed.",
    "setup.invite_already_sent": "Invite already sent.",
    "setup.invite_sent": "Invite sent.",
    "setup.invite_later": "You can add family later from Settings.",
    "setup.skip": "Skip for now",
    "setup.continue": "Continue",
    "setup.tutorial_intro": "Want a quick overview of the Amsterdam process?",
    "setup.tutorial_body":
      "This is not app training — it’s the 2025/26 Year‑8 process explained simply.",
    "setup.tutorial_start": "Start overview",
    "setup.tutorial_later": "You can always find this later in the menu.",

    "settings.title": "Settings",
    "settings.edit": "Edit settings",
    "settings.child_name": "Child name",
    "settings.postcode": "Postcode",
    "settings.house_number": "House number",
    "settings.advies1": "Advice",
    "settings.advies2": "Advice (optional)",
    "settings.advies_select": "Choose advice",
    "settings.both_levels": "Only show schools that offer BOTH levels",
    "settings.save": "Save",
    "settings.saving": "Saving...",
    "settings.language": "Language",
    "settings.lang_nl": "Dutch",
    "settings.lang_en": "English",

    "menu.settings": "Settings",
    "menu.how_it_works": "How it works",
    "menu.feedback": "Feedback",
    "menu.print": "Print / Export",
    "menu.admin": "Admin",
    "menu.signout": "Sign out",

    "nav.dashboard": "Dashboard",
    "nav.schools": "Schools",
    "nav.open_days": "Open days",
    "nav.shortlist": "Shortlist",

    "schools.title": "Schools",
    "schools.search": "Search schools…",
    "schools.sort": "Sort",
    "schools.sort_name": "Name",
    "schools.sort_bike": "Bike time",
    "schools.shortlist_add": "Add",
    "schools.shortlist_adding": "Adding...",
    "schools.shortlist_add_full": "Add to shortlist",
    "schools.shortlist_added_ranked": "Added to ranked list at #{rank}.",
    "schools.shortlist_added_unranked": "Added to shortlist (not ranked yet).",
    "schools.shortlist_already": "Already in shortlist.",

    "open_days.title": "Open days",
    "open_days.important": "Important",
    "open_days.important_body":
      "Open day details can change. Always verify on the school website before you go.",
    "open_days.shortlist_only": "Shortlist only",
    "open_days.show_inactive": "Show inactive",
    "open_days.event_type": "Event type",
    "open_days.when": "When",
    "open_days.all_dates": "All dates",
    "open_days.next7": "Next 7 days",
    "open_days.next14": "Next 14 days",

    "shortlist.title": "Ranked list",
    "shortlist.subtitle": "You can save more schools than you rank.",
    "shortlist.empty_slot": "Empty",
    "shortlist.empty_list": "No ranked schools yet.",
    "shortlist.save": "Save",
    "shortlist.saved": "Saved.",
    "shortlist.rank": "Rank",
    "shortlist.remove": "Remove",
    "shortlist.footer": "Next: add schools from the Schools list or School detail.",
    "shortlist.rank_cap": "Rank cap",
    "shortlist.saved_title": "Saved (not ranked yet)",
    "shortlist.rank_next": "Put on next rank",

    "how.title": "How it works",
    "how.subtitle":
      "A quick, kid‑friendly overview of the Amsterdam step‑by‑step process for 2025/26.",
    "how.next_title": "Next moments",
    "how.complete_cta": "I’ve read this",
    "how.completed": "Read ✓",
    "how.finish_setup": "Go to Dashboard",
    "how.to_dashboard": "Go to Dashboard",
    "how.list_title": "How long should your list be?",
    "how.list_intro": "Keuzegids recommends at least:",
    "how.list_4": "vmbo-b / vmbo-bk / vmbo-k / vmbo-kgl-tl: 4 schools",
    "how.list_6": "vmbo-gl-tl / vmbo-gl-tl-havo: 6 schools",
    "how.list_12": "havo / havo-vwo / vwo: 12 schools",
    "how.list_note":
      "If you also choose a profile class at the same school, your list may need to be longer.",
    "how.title_provisional": "Provisional advice (January)",
    "how.body_provisional":
      "You receive a provisional advice from school. It’s your starting point.",
    "how.title_orientation": "Explore (Nov–Feb)",
    "how.body_orientation":
      "Visit open days and compare schools using your checklist.",
    "how.title_doorstroom": "Doorstroomtoets (2–6 Feb)",
    "how.body_doorstroom":
      "All Year‑8 pupils take this test in this week.",
    "how.title_definitive": "Definitive advice (24 March)",
    "how.body_definitive":
      "You receive your final advice by this date.",
    "how.title_apply": "Central application week (25–31 March)",
    "how.body_apply":
      "Submit your ranked preference list online.",
    "how.title_placement": "Placement result (9 April)",
    "how.body_placement":
      "You’ll hear which school you’re placed in.",
    "how.title_second_round": "Second round (9–14 April)",
    "how.body_second_round":
      "Only if you didn’t get a place or change your mind.",
    "how.title_meet": "Meet your school (23/24 June)",
    "how.body_meet":
      "You attend the kennismakingsmiddag at your new school.",

    "feedback.title": "Feedback",
    "feedback.subtitle": "Share bugs, ideas, or questions. We read everything.",
    "feedback.category": "Category",
    "feedback.category_bug": "Bug",
    "feedback.category_idea": "Idea",
    "feedback.category_question": "Question",
    "feedback.category_other": "Other",
    "feedback.title_label": "Title (optional)",
    "feedback.message_label": "Message",
    "feedback.send": "Send feedback",
    "feedback.sending": "Sending...",
    "feedback.empty": "No feedback yet.",
    "feedback.your": "Your feedback",
    "feedback.response": "Response",
    "feedback.new_response": "New response",
    "feedback.thanks": "Thanks! We’ll take a look.",
  },
};

export function t(lang: Language, key: string) {
  return STRINGS[lang]?.[key] ?? STRINGS.en[key] ?? key;
}

export function getLocale(lang: Language) {
  return lang === "nl" ? "nl-NL" : "en-GB";
}

export function emitLanguageChanged(lang: Language) {
  if (typeof window === "undefined") return;
  window.dispatchEvent(new CustomEvent(LANGUAGE_EVENT, { detail: lang }));
}
