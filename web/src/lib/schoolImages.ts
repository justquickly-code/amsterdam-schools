export const SCHOOL_IMAGE_MAP: Record<string, string> = {
  "abc-noorderlicht": "/branding/school_images_edited/abc-noorderlicht/abc-noorderlicht.jpg",
  "alasca": "/branding/school_images_edited/alasca/alasca.jpg",
  "barlaeus-gymnasium": "/branding/school_images_edited/barlaeus-gymnasium/barlaeus-gymnasium.jpg",
  "berlage-lyceum": "/branding/school_images_edited/berlage-lyceum/berlage-lyceum.jpg",
  "bindelmeer-college": "/branding/school_images_edited/bindelmeer-college/bindelmeer-college.jpg",
  "bredero": "/branding/school_images_edited/bredero/bredero.jpg",
  "calandlyceum": "/branding/school_images_edited/calandlyceum/calandlyceum.jpg",
  "calvijn-college-amsterdam": "/branding/school_images_edited/calvijn-college-amsterdam/calvijn-college-amsterdam.png",
  "casparus-college": "/branding/school_images_edited/casparus-college/casparus-college.jpg",
  "cburg-college": "/branding/school_images_edited/cburg-college/cburg-college.jpeg",
  "cheider-vo": "/branding/school_images_edited/cheider-vo/cheider-vo.png",
  "college-de-meer": "/branding/school_images_edited/college-de-meer/college-de-meer.jpg",
  "college-zuyd": "/branding/school_images_edited/college-zuyd/college-zuyd.jpg",
  "comenius-lyceum-amsterdam": "/branding/school_images_edited/comenius-lyceum-amsterdam/comenius-lyceum-amsterdam.jpg",
  "cornelius-haga-lyceum": "/branding/school_images_edited/cornelius-haga-lyceum/cornelius-haga-lyceum.jpg",
  "csb": "/branding/school_images_edited/csb/csb.jpg",
  "cygnus-gymnasium": "/branding/school_images_edited/cygnus-gymnasium/cygnus-gymnasium.jpg",
  "damstede-lyceum": "/branding/school_images_edited/damstede-lyceum/damstede-lyceum.jpg",
  "de-amsterdamse-mavo": "/branding/school_images_edited/de-amsterdamse-mavo/de-amsterdamse-mavo.jpg",
  "de-apollo": "/branding/school_images_edited/de-apollo/de-apollo.jpg",
  "de-nieuwe-havo": "/branding/school_images_edited/de-nieuwe-havo/de-nieuwe-havo.jpg",
  "denise": "/branding/school_images_edited/denise/denise.jpg",
  "fiducie-college": "/branding/school_images_edited/fiducie-college/fiducie-college.jpg",
  "fons-vitae-lyceum": "/branding/school_images_edited/fons-vitae-lyceum/fons-vitae-lyceum.jpg",
  "futuris": "/branding/school_images_edited/futuris/futuris.jpg",
  "geert-groote-college-amsterdam": "/branding/school_images_edited/geert-groote-college-amsterdam/geert-groote-college-amsterdam.jpg",
  "gerrit-van-der-veen-college": "/branding/school_images_edited/gerrit-van-der-veen-college/gerrit-van-der-veen-college.jpg",
  "havo-de-hof": "/branding/school_images_edited/havo-de-hof/havo-de-hof.png",
  "hervormd-lyceum-west": "/branding/school_images_edited/hervormd-lyceum-west/hervormd-lyceum-west.jpg",
  "het-4e-gymnasium": "/branding/school_images_edited/het-4e-gymnasium/het-4e-gymnasium.jpg",
  "het-amsterdams-lyceum": "/branding/school_images_edited/het-amsterdams-lyceum/het-amsterdams-lyceum.jpg",
  "het-cartesius": "/branding/school_images_edited/het-cartesius/het-cartesius.jpg",
  "hlz": "/branding/school_images_edited/hlz/hlz.jpg",
  "hogelant": "/branding/school_images_edited/hogelant/hogelant.jpg",
  "hubertus-berkhoff": "/branding/school_images_edited/hubertus-berkhoff/hubertus-berkhoff.jpg",
  "huygens-college": "/branding/school_images_edited/huygens-college/huygens-college.jpg",
  "hyperion-lyceum": "/branding/school_images_edited/hyperion-lyceum/hyperion-lyceum.jpg",
  "iedersland-college": "/branding/school_images_edited/iedersland-college/iedersland-college.jpg",
  "ir-lely-lyceum": "/branding/school_images_edited/ir-lely-lyceum/ir-lely-lyceum.jpg",
  "ivko": "/branding/school_images_edited/ivko/ivko.jpg",
  "joodse-scholengemeenschap-maimonides": "/branding/school_images_edited/joodse-scholengemeenschap-maimonides/joodse-scholengemeenschap-maimonides.jpg",
  "jordaan-college": "/branding/school_images_edited/jordaan-college/jordaan-college.webp",
  "kairos-college": "/branding/school_images_edited/kairos-college/kairos-college.jpg",
  "kentalis-signis": "/branding/school_images_edited/kentalis-signis/kentalis-signis.jpg",
  "kiem-montessori": "/branding/school_images_edited/kiem-montessori/kiem-montessori.jpg",
  "kolom-praktijkcollege-de-atlant": "/branding/school_images_edited/kolom-praktijkcollege-de-atlant/kolom-praktijkcollege-de-atlant.jpg",
  "kolom-praktijkcollege-de-dreef": "/branding/school_images_edited/kolom-praktijkcollege-de-dreef/kolom-praktijkcollege-de-dreef.jpg",
  "kolom-praktijkcollege-het-plein": "/branding/school_images_edited/kolom-praktijkcollege-het-plein/kolom-praktijkcollege-het-plein.jpg",
  "kolom-praktijkcollege-noord": "/branding/school_images_edited/kolom-praktijkcollege-noord/kolom-praktijkcollege-noord.jpg",
  "kolom-vso-alphons-laudy": "/branding/school_images_edited/kolom-vso-alphons-laudy/kolom-vso-alphons-laudy.jpg",
  "kolom-vso-de-heldring": "/branding/school_images_edited/kolom-vso-de-heldring/kolom-vso-de-heldring.jpg",
  "kopklas-amsterdam": "/branding/school_images_edited/kopklas-amsterdam/kopklas-amsterdam.jpg",
  "luca": "/branding/school_images_edited/luca/luca.jpg",
  "lumion": "/branding/school_images_edited/lumion/lumion.jpg",
  "marcanti-college": "/branding/school_images_edited/marcanti-college/marcanti-college.jpg",
  "mediacollege-amsterdam": "/branding/school_images_edited/mediacollege-amsterdam/mediacollege-amsterdam.jpg",
  "meiberg-college": "/branding/school_images_edited/meiberg-college/meiberg-college.webp",
  "metis-montessori-lyceum": "/branding/school_images_edited/metis-montessori-lyceum/metis-montessori-lyceum.jpg",
  "metropolis-lyceum": "/branding/school_images_edited/metropolis-lyceum/metropolis-lyceum.jpg",
  "montessori-lyceum-amsterdam-mla": "/branding/school_images_edited/montessori-lyceum-amsterdam-mla/montessori-lyceum-amsterdam-mla.jpg",
  "montessori-lyceum-oostpoort": "/branding/school_images_edited/montessori-lyceum-oostpoort/montessori-lyceum-oostpoort.jpg",
  "montessori-lyceum-pax": "/branding/school_images_edited/montessori-lyceum-pax/montessori-lyceum-pax.png",
  "montessori-lyceum-terra-nova": "/branding/school_images_edited/montessori-lyceum-terra-nova/montessori-lyceum-terra-nova.webp",
  "mundus-college": "/branding/school_images_edited/mundus-college/mundus-college.jpeg",
  "orion-college-amstel": "/branding/school_images_edited/orion-college-amstel/orion-college-amstel.jpg",
  "orion-college-drostenburg": "/branding/school_images_edited/orion-college-drostenburg/orion-college-drostenburg.webp",
  "orion-college-noord": "/branding/school_images_edited/orion-college-noord/orion-college-noord.jpg",
  "orion-college-zuidoost": "/branding/school_images_edited/orion-college-zuidoost/orion-college-zuidoost.jpg",
  "osb-amsterdam": "/branding/school_images_edited/osb-amsterdam/osb-amsterdam.jpg",
  "over-y-college": "/branding/school_images_edited/over-y-college/over-y-college.jpg",
  "pieter-nieuwland-college": "/branding/school_images_edited/pieter-nieuwland-college/pieter-nieuwland-college.jpg",
  "spinoza-lyceum": "/branding/school_images_edited/spinoza-lyceum/spinoza-lyceum.jpg",
  "spinoza20first": "/branding/school_images_edited/spinoza20first/spinoza20first.jpg",
  "spring-high": "/branding/school_images_edited/spring-high/spring-high.jpg",
  "st-ignatiusgymnasium": "/branding/school_images_edited/st-ignatiusgymnasium/st-ignatiusgymnasium.jpg",
  "st-nicolaaslyceum": "/branding/school_images_edited/st-nicolaaslyceum/st-nicolaaslyceum.jpg",
  "sweelinck-college": "/branding/school_images_edited/sweelinck-college/sweelinck-college.webp",
  "tasc-tech-amsterdam-scholen-collectief": "/branding/school_images_edited/tasc-tech-amsterdam-scholen-collectief/tasc-tech-amsterdam-scholen-collectief.jpg",
  "tobiasschool": "/branding/school_images_edited/tobiasschool/tobiasschool.jpg",
  "vechtstede-college": "/branding/school_images_edited/vechtstede-college/vechtstede-college.webp",
  "viertaal-college-amsterdam": "/branding/school_images_edited/viertaal-college-amsterdam/viertaal-college-amsterdam.webp",
  "vinse-school": "/branding/school_images_edited/vinse-school/vinse-school.jpg",
  "visio-onderwijs-amsterdam": "/branding/school_images_edited/visio-onderwijs-amsterdam/visio-onderwijs-amsterdam.jpg",
  "vonk": "/branding/school_images_edited/vonk/vonk.webp",
  "voort-college": "/branding/school_images_edited/voort-college/voort-college.webp",
  "vossius-gymnasium": "/branding/school_images_edited/vossius-gymnasium/vossius-gymnasium.jpg",
  "vox-college": "/branding/school_images_edited/vox-college/vox-college.jpg",
  "xplore-agora-amsterdam": "/branding/school_images_edited/xplore-agora-amsterdam/xplore-agora-amsterdam.png",
  "yuverta-vmbo-amsterdam-west": "/branding/school_images_edited/yuverta-vmbo-amsterdam-west/yuverta-vmbo-amsterdam-west.jpg",
  "yuverta-vmbo-en-pro-amsterdam-oost": "/branding/school_images_edited/yuverta-vmbo-en-pro-amsterdam-oost/yuverta-vmbo-en-pro-amsterdam-oost.webp"
} as const;

export function schoolImageForSlug(slug: string): string | null {
  return SCHOOL_IMAGE_MAP[slug] ?? null;
}

export function slugifySchoolName(name: string): string {
  return name
    .toLowerCase()
    .normalize("NFKD")
    .replace(/[^\p{Letter}\p{Number}]+/gu, "-")
    .replace(/(^-|-$)/g, "");
}

export function schoolImageForName(name: string): string | null {
  const candidates = new Set<string>();
  const add = (value: string) => {
    const slug = slugifySchoolName(value);
    if (slug) candidates.add(slug);
  };

  add(name);
  add(name.replace(/\s*\(.*?\)\s*/g, " ").trim());
  add(name.split(" - ")[0].trim());
  add(name.split(" â€“ ")[0].trim());
  add(name.replace(/&/g, "en"));

  for (const slug of Array.from(candidates)) {
    const stripped = slug.replace(/^(de|het|een)-/, "");
    if (stripped) candidates.add(stripped);
  }

  for (const slug of candidates) {
    const direct = schoolImageForSlug(slug);
    if (direct) return direct;
  }

  const keys = Object.keys(SCHOOL_IMAGE_MAP);
  for (const slug of candidates) {
    const match = keys.find((key) => key.startsWith(slug) || slug.startsWith(key));
    if (match) return SCHOOL_IMAGE_MAP[match] ?? null;
  }

  return null;
}
