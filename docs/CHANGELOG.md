# Changelog

## Unreleased
- Nav: increase My list heart icon size and stroke weight for parity with VO.
- Nav: normalize mobile icon alignment and spacing to match VO bottom bar layout.
- Explore: add light pill background behind wordmark for readability on hero image.
- Nav: switch heart tab to My list and increase heart icon size.
- Explore: move language toggle to top-right on the hero screen; remove login button there.
- Nav: schools tab icon switched to heart; my list uses list icon.
- Nav: bottom tab bar now shows icons + labels with red active state to match VO design.
- Nav: hide bottom nav on tablet/desktop; show top-right menu with language toggle (public + authed items).
- Nav: show 3-item bottom nav when logged out (Explore/Schools/Sign in); full 5-item nav after login.
- Explore: add public hero landing page with search + featured schools; move dashboard to /profile and update bottom nav labels.
- Dashboard: align header layout and unify planner list (timeline + planned open days) with clickable items.
- Planner: normalize open-day school join shape to keep advies filtering working reliably.
- Shortlist: show rating + commute time/distance for ranked and unranked items.
- UI: Wordmark now uses object-contain to avoid stretching across headers.
- Admin: add user stats page (rolling 7 days, UTC) sourced from Supabase Auth users.
- Build: normalize planned open-days join shape on dashboard to prevent TS build failure.
- UI kit: move kit source to docs/ui-kit and keep public assets in web/public/branding/ui-kit.
- Theme: apply UI kit color tokens and Nunito font as base styling.
- Docs: add Phase 6 plan for production readiness, iOS PWA login, UX polish, and analytics.
- UI: add About page with a simple flow walkthrough (includes feedback step + good-luck note) and link in top menu.
- Shortlist: link each school card to its school detail page; back returns to shortlist.
- Admin: feedback dots now appear on admin menu + admin home; clear after viewing feedback list.
- Invite: reduce confusion for first-time members by skipping workspace-choice screen when only one workspace.
- Dashboard: use “{child}'s Dashboard” title instead of “Welcome”.
- Login: add spam/junk hint after sending magic link.
- Invites: attach child_name + inviter_email metadata for richer email templates.
- Docs: note iOS Home Screen (PWA) limitation and recommend Safari until in-app auth flow exists.
- Tutorial: add /how-it-works page with Keuzegids timeline, next dates, and shortlist length guidance.
- Setup: add optional tutorial step after invites; “finish setup” now routes through tutorial or dashboard.
- Dashboard: add “next important dates” widget and recent-completed list in progress panel.
- Shortlist: advice-based rank cap with unranked saved list; “rank next” swaps out bottom slot when full.
- Shortlist print: include only ranked items up to cap; show cap in header.
- Data: track tutorial completion per member via workspace_members.tutorial_completed_at.
- Auth: use token_hash for magic-link verify; guard invite session nulls; settings error handling.
- Admin sync: count deactivated/reactivated open days via returned rows to satisfy TS build.
- Docs: clarify scope to central lottery/matching schools and exclude praktijkonderwijs/VSO/kopklas/kovo/schakelklassen.
- Admin sync: supplement Schoolwijzer with Keuzegids regular VO schools (including address/website) if missing from API.
- Admin sync: geocode supplemental schools via Mapbox when available.
- Docs: plan Keuzegids tutorial, menu entry, and dashboard next-date widget (Phase 5).
- Docs: clarify setup flow sequencing, tutorial intent, and progress bar “recently completed” list.
- Docs: add Keuzegids guidance on recommended shortlist length by advice (4/6/12 + profile-class caveat).
- Docs: update ranked list cap wording by advice.
- Admin: show feedback notification dot when new items arrive.
- Feedback: add “new response” indicator in menu and per-item badge.
- Feedback: add user feedback page, admin console, and response support.
- Setup: remove commute-calculating helper text from invite step.
- Setup: skip redirect when setup=done query param is present.
- Setup: pass setup=done to prevent redirect loop after invite step.
- Setup: avoid redirect loop right after profile save (short grace window).
- Setup: initialize grace window before redirect to prevent immediate bounce back.
- Setup: skip/continue now go straight to Dashboard (no intermediate welcome flash).
- Auth: persist chosen language through magic-link redirect via lang param.
- Auth: canonicalize localhost redirects to preserve stored language on login.
- Language: fall back to stored preference when workspace language is unset.
- Login: persist language immediately when toggling to keep setup in sync.
- Login: fix hydration mismatch by deferring language read to client.
- Setup: show language toggle and keep login language through setup.
- Dashboard: fix hook order by moving redirect effect before early returns.
- Dashboard: redirect signed-out users directly to /login (remove redundant screen).
- Dashboard (signed-out): add language toggle and persist the selection.
- Dashboard: mark “invite family” milestone complete after sending an invite in setup.
- Setup: respect login language choice and persist it when profile is saved.
- Invite: warn when joining a new workspace and let members keep their current workspace.
- Settings: add workspace switcher when multiple memberships exist.
- Setup: add optional invite step with shared-workspace explanation and “skip for now”.
- Login: add language toggle (NL/EN).
- Shortlist: move rank controls to header to reduce card height.
- Shortlist: show rating stars and bike distance for each school.
- Open Days: remove "show inactive" toggle from public planner.
- UI: rename attended labels to visited for flexibility beyond open days.
- Dashboard: switch progress markers to emoji stars for better visibility.
- Dashboard: add simple progress bar with milestone tips (profile, invite, shortlist, notes, rating, attended).
- Dashboard: remove redundant shortlist section.
- Dashboard: shorten upcoming open days label.
- Schools: shorten bike-sort helper text and only warn when commute times are missing.
- Schools: fix bike-sort missing-commutes check in UI.
- Schools: persist sort mode via localStorage without initial overwrite.
- Schools: persist sort mode between sessions.
- Settings: invite flow now defaults all members to editor (no viewer option).
- Settings: advies is a single dropdown with combined options (e.g., HAVO/VWO) using "either" matching.
- Docs: add future feature ideas pack (gamification, data quality, reporting, auth, monetisation).
- Docs: mark RELEASE_PLAN complete through Phase 4 (Jan 18, 2026).
- Schools detail: fix hook order error after language toggle changes.
- Setup: after completion, redirect from welcome screen to Dashboard.
- Docs: add future idea for gamified dashboard progress (ranked list + visits + notes).
- Public /planner: remove/hide “Show inactive” toggle (not intuitive for end users).
- Admin: keep “Show inactive” capability, move it to an admin-only open-days view (/admin/open-days).
- Docs: clarified canonical planner route and ranked list wording; added Doc Audit Report to CHANGELOG_AUDIT.
- Docs: aligned PRD-status CL IDs, Open Days routing notes, ranked subset wording, planned open day model, and admin auth requirements.
- Docs: aligned Open Days wording in README/PRD-status/Cursor prompt pack.
- Docs: removed boilerplate web/README.md (use root README only).
- Docs: added minimal web/README.md pointer to root README.
- Admin: compute-commutes now requires explicit workspace_id and validates against session.
- Security: open-days ICS endpoint no longer uses service role.
- Open Days: calendar download now uses authenticated fetch to support RLS.
- Admin: sync-open-days now requires ADMIN_SYNC_TOKEN in production (fail-closed).
- Routes: /planner is canonical; /open-days now redirects to /planner.
- Shortlist: added /shortlist/print export view with print button.
- Schools: added sort toggle for Name/Bike time with unknown commutes last.
- Open Days: syncedAt uses latest row, year defaults to latest with selector, and event types normalized.
- Commutes: added user-safe on-demand compute for missing commutes.
- Settings: saving home address triggers background commute compute.
- Settings: normalize postcode to 1234AB and enforce postcode+house pairing.
- Commutes: changing home address clears cached commutes and forces re-geocode.
- Open Days: removed commute times from the planner list (reduces visual noise).
- Commutes: address changes can force recompute even if cache clear is blocked.
- Commutes: compute endpoint now reports route/upsert failures for debugging.
- RLS: allow workspace members to read/write commute_cache (owner can delete).
- Commutes: Settings now computes all school commutes in batches; Schools page avoids background refresh.
- Admin: admin token stored in sessionStorage only; admin APIs require allowlisted email.
- Admin: admin pages now gate access for non-allowlisted users.
- UI: removed oai_citation artifact from admin sync copy.
- Commutes: Settings computes only missing commutes when address unchanged.
- Shortlist: retry once on rank conflict before failing.
- UI: friendly labels for supported levels (e.g., VMBO variants).
- Docs: marked completed CL items as DONE in CHANGELOG_AUDIT.
- Docs: added Phase 4 to RELEASE_PLAN for remaining MVP commitments.
- UI: added bottom nav and dashboard content; dashboard is default landing after login.
- Dashboard: upcoming open days are filtered to shortlist when available.
- UX: first-run setup gate blocks main screens until address + advies are set.
- Setup: added child name field and dedicated setup wizard.
- Setup: require postcode + house number in setup wizard.
- Setup: computes bike commutes after finishing setup.
- Settings: removed redundant summary block above form.
- UI: bottom nav now 4 items; sign out + account info moved to Settings.
- UI: removed top-of-page nav links (Home/Schools/Settings) to reduce clutter.
- UI: added top-right menu with settings, print/export, and sign out.
- UI: added back link on school detail; adjusted top menu spacing.
- UI: removed shortlist print link from page (now in top menu).
- Open Days: add planned toggle in planner + school detail; highlight schools missing planned open day.
- Settings: add workspace members list + invite flow (owners only).
- Members: invite email link now joins workspace directly (no pre-sign-in).
- Visits: notes are per member; shared rating/attended remain.
- UI: language toggle in top menu (Dutch default, English optional), live updates without refresh.
- Docs: updated PRD-status + AGENTS with completed Phase 4 items and current state summary.
